2025-08-19 20:13:12,662 - src.training.trainer - INFO - Trainer initialized for experiment: test_historical_small
2025-08-19 20:13:12,662 - src.training.trainer - INFO - Setting up environment with 2 goals in historical mode
2025-08-19 20:13:12,663 - src.training.trainer - INFO - Setting up historical data loader...
2025-08-19 20:13:12,950 - src.data.historical_data_loader - INFO - Loaded S&P 500 data: 168 records
2025-08-19 20:13:12,950 - src.data.historical_data_loader - INFO - Loaded bond data: 168 records
2025-08-19 20:13:12,951 - src.data.historical_data_loader - INFO - Loaded 15 portfolio configurations
2025-08-19 20:13:12,959 - src.data.historical_data_loader - INFO - Computed returns for 15 portfolios
2025-08-19 20:13:12,959 - src.data.historical_data_loader - INFO - Data length: 168 time periods
2025-08-19 20:13:12,959 - src.data.historical_data_loader - INFO - Historical data loaded: 168 time periods
2025-08-19 20:13:12,959 - root - INFO - Historical data validation: {'total_periods': 168, 'num_portfolios': 15, 'available_16y_sequences': 153, 'date_range': {'start': '2010-01-31 00:00:00', 'end': '2023-12-31 00:00:00'}, 'missing_values': 30, 'portfolio_statistics': [{'portfolio_id': 0, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 1, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 2, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 3, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 4, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 5, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 6, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 7, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 8, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 9, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 10, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 11, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 12, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 13, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}, {'portfolio_id': 14, 'mean_return': nan, 'std_return': nan, 'min_return': nan, 'max_return': nan}]}
2025-08-19 20:13:12,959 - src.training.trainer - INFO - Historical data loaded: 168 periods
2025-08-19 20:13:12,959 - src.training.trainer - INFO - Available 16-year sequences: 153
2025-08-19 20:13:12,960 - src.training.trainer - WARNING - Limited historical sequences (153) vs batch size (1000). Training will use repeated sequences.
2025-08-19 20:13:12,960 - src.environment.gbwm_env - INFO - Historical mode: 153 sequences available
2025-08-19 20:13:12,961 - src.environment.gbwm_env - INFO - GBWM Environment initialized in historical mode
2025-08-19 20:13:12,961 - src.training.trainer - INFO - Environment created with initial wealth: $216,300
2025-08-19 20:13:12,961 - src.training.trainer - INFO - Goal schedule: [8, 16]
2025-08-19 20:13:12,961 - src.training.trainer - INFO - Data mode: historical
2025-08-19 20:13:12,961 - src.training.trainer - INFO - Setting up PPO agent
2025-08-19 20:13:13,576 - src.training.trainer - INFO - Agent created on device: cpu
2025-08-19 20:13:13,576 - src.training.trainer - INFO - Policy network parameters: 5,457
2025-08-19 20:13:13,576 - src.training.trainer - INFO - Value network parameters: 4,417
2025-08-19 20:13:13,576 - src.training.trainer - INFO - ============================================================
2025-08-19 20:13:13,576 - src.training.trainer - INFO - STARTING TRAINING
2025-08-19 20:13:13,576 - src.training.trainer - INFO - ============================================================
2025-08-19 20:13:13,576 - src.training.trainer - INFO - Total iterations: 5
2025-08-19 20:13:13,576 - src.training.trainer - INFO - Total timesteps: 80,000
2025-08-19 20:13:13,576 - src.training.trainer - INFO - Batch size: 1000
2025-08-19 20:13:13,576 - src.training.trainer - INFO - Time horizon: 16
2025-08-19 20:13:13,576 - src.training.trainer - INFO - ============================================================
2025-08-19 20:13:13,577 - src.training.trainer - INFO - Configuration saved: /Users/goutamgupta/Desktop/workspace/fintech/gbwm_reinforcement_learning/data/results/test_historical_small/config.json
2025-08-19 20:13:17,375 - src.training.trainer - INFO - Iteration    0 | Reward:    8.64 | PolicyLoss:  -0.0688 | ValueLoss:  50.6199 | LR: 0.008000 | Episodes:   1000
2025-08-19 20:13:17,382 - src.models.ppo_agent - INFO - Agent saved to /Users/goutamgupta/Desktop/workspace/fintech/gbwm_reinforcement_learning/data/results/test_historical_small/checkpoints/checkpoint_0000.pth
2025-08-19 20:13:17,595 - src.training.trainer - INFO - EVAL    0 | Reward:   18.00Â±0.00 | Goals: 50.0% | Wealth: $292,384
2025-08-19 20:13:32,737 - src.training.trainer - INFO - ============================================================
2025-08-19 20:13:32,737 - src.training.trainer - INFO - TRAINING COMPLETED
2025-08-19 20:13:32,737 - src.training.trainer - INFO - Total training time: 19.16 seconds
2025-08-19 20:13:32,737 - src.training.trainer - INFO - Time per iteration: 3.83 seconds
2025-08-19 20:13:32,737 - src.training.trainer - INFO - ============================================================
2025-08-19 20:13:32,790 - src.models.ppo_agent - INFO - Agent saved to /Users/goutamgupta/Desktop/workspace/fintech/gbwm_reinforcement_learning/data/results/test_historical_small/final_model.pth
2025-08-19 20:13:32,790 - src.training.trainer - INFO - Final results saved: /Users/goutamgupta/Desktop/workspace/fintech/gbwm_reinforcement_learning/data/results/test_historical_small/training_results.json
2025-08-19 20:13:32,791 - src.training.trainer - INFO - Final model saved: /Users/goutamgupta/Desktop/workspace/fintech/gbwm_reinforcement_learning/data/results/test_historical_small/final_model.pth
